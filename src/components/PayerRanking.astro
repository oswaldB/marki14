<!-- src/components/PayerRanking.astro -->
<-
interface Props {
  title: string;
  payers: Array<{
    name: string;
    amount: number;
    delay: number;
    invoiceCount: number;
  }>;
  rankingType: 'delay' | 'amount';
}

const { title, payers, rankingType } = Astro.props;

// Trier les payeurs selon le type de classement
const sortedPayers = [...payers].sort((a, b) => {
  if (rankingType === 'delay') {
    return b.delay - a.delay; // Du plus grand retard au plus petit
  } else {
    return b.amount - a.amount; // Du montant le plus élevé au plus bas
  }
});

// Formater le montant en euros
const formatCurrency = (amount) => {
  return new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' }).format(amount);
};
-->

<div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
  <h3 class="text-lg font-semibold text-gray-900 mb-4">{title}</h3>
  
  <div class="space-y-3">
    {sortedPayers.length > 0 ? (
      sortedPayers.map((payer, index) => (
        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors">
          <div class="flex items-center space-x-3">
            <span class="w-6 h-6 bg-[#007ACE] bg-opacity-20 rounded-full flex items-center justify-center text-sm font-medium text-[#007ACE]">{index + 1}</span>
            <span class="font-medium text-gray-900">{payer.name}</span>
            {rankingType === 'delay' ? (
              <span class="text-sm text-red-600 font-medium">{payer.delay} jours max</span>
            ) : (
              <span class="text-sm text-gray-500">{payer.invoiceCount} factures</span>
            )}
          </div>
          <span class="font-semibold text-[#007ACE]">
            {rankingType === 'delay' ? formatCurrency(payer.amount) : formatCurrency(payer.amount)}
          </span>
        </div>
      ))
    ) : (
      <div class="text-center py-4 text-gray-500">
        Aucun payeur trouvé
      </div>
    )}
  </div>
</div>